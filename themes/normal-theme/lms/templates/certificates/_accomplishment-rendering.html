<%page expression_filter="h"/>
<%! from django.utils.translation import ugettext as _ %>
<%namespace name='static' file='../static_content.html'/>
<%
course_mode_class = course_mode if course_mode else ''
%>

<main class="accomplishment accomplishment-main">
    <div class="wrapper-accomplishment-rendering-header">
        ${document_banner}
    </div>
    <div class="wrapper-accomplishment-rendering">
        <div id="container" style="text-align:center">

        </div>
    </div>
    <div class="wrapper-accomplishment-extend-info">
        <h2 class="accomplishment-extend-info-title hd-6">${accomplishment_copy_more_about}</h2>
        <div class="accomplishment-extend-info-data">
            <span class="recipient-img">
                <img class="src" src="/static/certificates/images/demo-user-profile.png" alt="Recipient Image">
            </span>
            <div class="recipient-details first">
                <h3 class="recipient-name">${accomplishment_copy_name}</h3>
                <p class="recipient-username">${accomplishment_copy_username} @ ${platform_name}</p>
            </div>
            <div class="recipient-details">
                <p>${certificate_id_number_title}: ${certificate_id_number}</p>
                <p>${certificate_date_issued_title}${certificate_date_issued}</p>
            </div>
        </div>
    </div>
</main>
<div style="display:none">
    <canvas width="1170" height="826"  id="canvas">

    </canvas>
    <div id="img-list">
        <img id="bg" src="/static/normal-theme/images/certificates/zh-cn.png" />
        % if certificate_data:
            % for signatory in certificate_data.get('signatories', []):
                <img name="${signatory['name']}" class="signature" src="${signatory['signature_image_path']}" alt="${signatory['name']}">
            % endfor
        % endif
    </div>
    <div id="qrcode"></div>
    <div id="url" style="display: none">${verify_url}</div>
</div>
<script src="/static/normal-theme/js/certificates/canvas.js"></script>
<script src="/static/normal-theme/js/certificates/qrcode.js"></script>
<script>
    var url = $.trim($('#url').text());
    url = location.protocol+ '//' + location.host + url;   
    var data = {    
        text: url,
        width: 78,
        height: 78,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    }
    var qrcode = new QRCode(document.getElementById("qrcode"), data);
    $(document).ready(function(){
        var data = {
            username: '${accomplishment_copy_name}',
            course: '${accomplishment_copy_course_name}',
            course_id: '${course_number}',
            dateTime: '${certificate_date_issued_title}',
            date: '${certificate_date_issued}',
            verifyTitle: '验证地址',
            verifyAdress: url,
        }
        var i = 0;
        $('#img-list .signature').load(function(){
            i++;
            if (i == $('#img-list .signature').length){
                _certificates(data)
            }
        })
    })    
</script>